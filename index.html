<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Mini-Lathe Change Gear Calculator</title>
    <meta name="description" content="Calculate alternative gears for cutting threads on a 7x12 mini-lathe (Sieg SC2). Works with 1.5mm pitch or 16 TPI leadscrew.">
    <link rel="stylesheet" href="css/styles.css">
</head>
<body>
    <header>
        <div class="container">
            <img src="images/logo-50px.webp" alt="Logo" style="display: inline-block; vertical-align: middle; margin-right: 1rem;">
            <h1 style="display: inline-block; vertical-align: middle;">Mini-Lathe Change Gear Calculator</h1>
            <p style="margin-top: 0.5rem; color: #666; font-size: 0.9rem;">Calculate gear combinations for threading on 7x12 mini-lathes</p>
        </div>
    </header>

    <main>
        <!-- About Section (Collapsible) -->
        <div class="collapsible-section">
            <div class="collapsible-header" onclick="toggleCollapsible('about')">
                <h3>About This Calculator</h3>
                <span class="collapsible-toggle" id="about-toggle">â–¼</span>
            </div>
            <div class="collapsible-content" id="about-content">
                <div class="collapsible-content-inner">
                    <p>This tool can calculate alternative gears that can be used to cut a particular thread on a 7x12 mini-lathe like the Sieg SC2.
                    It works with either a 1.5&nbsp;mm pitch leadscrew or a 16&nbsp;TPI one.</p>

                    <p>The calculator is heavily based on the work of <a href="http://www.varmintal.com/alath.htm" target="_blank" rel="noopener">Al&nbsp;Harral</a>.
                    The code is based on Al&nbsp;Harral's <a href="http://www.varmintal.com/gears.bas" target="_blank" rel="noopener">GEARS.BAS</a>,
                    originally ported to the web by <a href="https://www.cgtk.co.uk/metalwork/calculators/changegears/minilathe" target="_blank" rel="noopener">A.&nbsp;S.&nbsp;Budden</a>,
                    and modernized to modern JavaScript for offline use.</p>
                </div>
            </div>
        </div>

        <section class="calculator">
            <h2>Calculator</h2>

            <!-- Setup Section (Collapsible) -->
            <div class="collapsible-section">
                <div class="collapsible-header" onclick="toggleCollapsible('setup')">
                    <h3>Setup (Leadscrew & Available Gears)</h3>
                    <span class="collapsible-toggle" id="setup-toggle">â–¼</span>
                </div>
                <div class="collapsible-content" id="setup-content">
                    <div class="collapsible-content-inner">
                        <table class="calcInputForm">
                            <tbody>
                                <tr>
                                    <td>Leadscrew:</td>
                                    <td>
                                        <div class="radio-group">
                                            <label>
                                                <input type="radio" id="metric_ls" name="leadscrew_type" value="metric">
                                                Metric (1.5&nbsp;mm pitch)
                                            </label>
                                            <label>
                                                <input type="radio" id="imperial_ls" name="leadscrew_type" value="imperial" checked>
                                                Imperial (16&nbsp;tpi)
                                            </label>
                                        </div>
                                    </td>
                                </tr>
                                <tr>
                                    <td>Available Gears:</td>
                                    <td>
                                        <input type="text" id="gears1" value="" placeholder="e.g., 20,20,30,35,40,40,45">
                                        <br><br>
                                        <input type="text" id="gears2" value="" placeholder="e.g., 50,55,57,60,65,80,80">
                                        <br><br>
                                        <input type="text" id="gears3" value="" placeholder="Additional gears (optional)">
                                        <small style="display: block; margin-top: 0.5rem; color: #666;">
                                            Enter comma-separated gear tooth counts
                                        </small>
                                    </td>
                                </tr>
                                <tr>
                                    <td>Options:</td>
                                    <td>
                                        <div class="checkbox-group">
                                            <label>
                                                <input type="checkbox" id="includeall" name="includeall" checked>
                                                Always show four-gear options
                                            </label>
                                        </div>
                                    </td>
                                </tr>
                                <tr>
                                    <td></td>
                                    <td>
                                        <button type="button" onclick="saveSettings()" style="margin-top: 1rem; padding: 0.5rem 1rem; background-color: #27ae60; color: white; border: none; border-radius: 4px; cursor: pointer;">
                                            ðŸ’¾ Save Settings
                                        </button>
                                        <small style="display: block; margin-top: 0.5rem; color: #666;">
                                            Settings will be automatically loaded on next visit
                                        </small>
                                    </td>
                                </tr>
                            </tbody>
                        </table>
                    </div>
                </div>
            </div>

            <!-- Calculate Single Thread Section (Collapsible) -->
            <div class="collapsible-section">
                <div class="collapsible-header" onclick="toggleCollapsible('single')">
                    <h3>Calculate Single Thread</h3>
                    <span class="collapsible-toggle open" id="single-toggle">â–¼</span>
                </div>
                <div class="collapsible-content open" id="single-content">
                    <div class="collapsible-content-inner">
                        <form class="calc-form">
                            <table class="calcInputForm">
                                <tbody>
                                    <tr>
                                        <td>Target Type:</td>
                                        <td>
                                            <div class="radio-group">
                                                <label>
                                                    <input type="radio" id="getpitch" name="target" value="pitch">
                                                    Metric Pitch (mm)
                                                </label>
                                                <label>
                                                    <input type="radio" id="gettpi" name="target" value="tpi" checked>
                                                    Imperial TPI (threads per inch)
                                                </label>
                                            </div>
                                        </td>
                                    </tr>
                                    <tr id="pitch-row" class="hidden">
                                        <td>Target Pitch:</td>
                                        <td>
                                            <input type="number" id="pitch" name="pitch" min="0.1" step="0.05" value="1.5">
                                            <small style="display: inline-block; margin-left: 0.5rem; color: #666;">mm</small>
                                        </td>
                                    </tr>
                                    <tr id="tpi-row">
                                        <td>Target TPI:</td>
                                        <td>
                                            <input type="number" id="tpi" name="tpi" min="0.5" step="0.5" value="16">
                                            <small style="display: inline-block; margin-left: 0.5rem; color: #666;">threads per inch</small>
                                        </td>
                                    </tr>
                                    <tr>
                                        <td></td>
                                        <td>
                                            <input type="submit" value="Calculate Gear Combinations">
                                        </td>
                                    </tr>
                                </tbody>
                            </table>
                        </form>

                        <div style="margin-top: 2rem;">
                            <h4>Results</h4>
                            <div id="holder">
                                <p class="info-message">Enter your parameters above and click "Calculate Gear Combinations" to see results.</p>
                            </div>
                        </div>
                    </div>
                </div>
            </div>

            <!-- Calculate Threading Chart Section (Collapsible) -->
            <div class="collapsible-section">
                <div class="collapsible-header" onclick="toggleCollapsible('chart')">
                    <h3>Calculate Threading Chart</h3>
                    <span class="collapsible-toggle" id="chart-toggle">â–¼</span>
                </div>
                <div class="collapsible-content" id="chart-content">
                    <div class="collapsible-content-inner">
                        <p style="color: #666; margin-bottom: 1rem;">
                            Generate a chart of gear combinations for multiple thread specifications at once.
                        </p>

                        <table class="calcInputForm">
                            <tbody>
                                <tr>
                                    <td style="vertical-align: top;">Target TPI Values:</td>
                                    <td>
                                        <textarea id="chart-tpi" rows="4" style="width: 100%; max-width: 400px; padding: 0.5rem; border: 1px solid #ddd; border-radius: 4px; font-family: inherit;" placeholder="e.g., 8,10,12,14,16,18,20,24"></textarea>
                                        <small style="display: block; margin-top: 0.5rem; color: #666;">
                                            Enter comma-separated TPI values (Imperial)
                                        </small>
                                    </td>
                                </tr>
                                <tr>
                                    <td style="vertical-align: top;">Target Pitch Values:</td>
                                    <td>
                                        <textarea id="chart-pitch" rows="4" style="width: 100%; max-width: 400px; padding: 0.5rem; border: 1px solid #ddd; border-radius: 4px; font-family: inherit;" placeholder="e.g., 0.5,0.75,1.0,1.25,1.5,2.0"></textarea>
                                        <small style="display: block; margin-top: 0.5rem; color: #666;">
                                            Enter comma-separated pitch values in mm (Metric)
                                        </small>
                                    </td>
                                </tr>
                                <tr>
                                    <td></td>
                                    <td>
                                        <button type="button" onclick="calculateThreadChart()" style="padding: 0.75rem 1.5rem; background-color: #3498db; color: white; border: none; border-radius: 4px; cursor: pointer; font-size: 1rem; font-weight: bold;">
                                            ðŸ“Š Calculate Thread Chart
                                        </button>
                                    </td>
                                </tr>
                            </tbody>
                        </table>

                        <div id="chart-results" style="margin-top: 2rem;">
                            <p class="info-message">Enter TPI and/or pitch values above and click "Calculate Thread Chart" to generate the chart.</p>
                        </div>
                    </div>
                </div>
            </div>

        <section class="diagram">
            <h2>Gear Configuration</h2>
            <div class="image-container">
                <img src="images/change_gears.webp" alt="Mini-lathe change gear configuration diagram" loading="lazy">
            </div>
            <p style="text-align: center; color: #666; font-size: 0.9rem;">
                Diagram showing the change gear configuration on a mini-lathe
            </p>
        </section>

        <section class="instructions">
            <h2>How to Use</h2>
            <ol>
                <li><strong>Select your leadscrew type:</strong> Choose between metric (1.5mm pitch) or imperial (16 TPI)</li>
                <li><strong>Enter available gears:</strong> List the gear tooth counts you have available, separated by commas</li>
                <li><strong>Choose target type:</strong> Select whether you want to cut metric threads (pitch in mm) or imperial threads (TPI)</li>
                <li><strong>Enter target value:</strong> Specify the pitch or TPI you want to achieve</li>
                <li><strong>Calculate:</strong> Click the button to see all possible gear combinations</li>
            </ol>
            
            <h3>Understanding the Results</h3>
            <ul>
                <li><strong>Gear A:</strong> Driver gear on the spindle</li>
                <li><strong>Gear B:</strong> Idler gear (if needed) - "ANY" means any gear will work</li>
                <li><strong>Gear C:</strong> Second idler gear (if needed)</li>
                <li><strong>Gear D:</strong> Driven gear on the leadscrew</li>
                <li><strong>Actual Value:</strong> The precise pitch or TPI you'll achieve with this combination</li>
            </ul>
            
            <p><strong>Note:</strong> The calculator first tries to find simple two-gear solutions. If none are found (or if you check "Always show four-gear options"), it will show four-gear compound solutions.</p>
        </section>
    </main>

    <footer>
        <p>
            <strong>Mini-Lathe Change Gear Calculator</strong><br>
            Based on Al Harral's GEARS.BAS | Original web version by A. S. Budden (<a href="https://www.cgtk.co.uk/metalwork/calculators/changegears/minilathe" target="_blank" rel="noopener">CGTK.co.uk</a>) | Modernized for offline use<br>
            <small>This is a free, open-source tool for the machining community</small>
        </p>
    </footer>

    <script src="js/calculator.js"></script>
</body>
</html>

