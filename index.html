<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Mini-Lathe Change Gear Calculator</title>
    <meta name="description" content="Calculate alternative gears for cutting threads on a 7x12 mini-lathe (Sieg SC2). Works with 1.5mm pitch or 16 TPI leadscrew.">
    <link rel="stylesheet" href="css/styles.css">
</head>
<body>
    <header>
        <div class="container">
            <div class="header-content">
                <img src="images/logo.svg" alt="Gear Calculator Logo" class="header-logo">
                <div class="header-text">
                    <h1>Mini-Lathe Change Gear Calculator</h1>
                    <p class="header-subtitle">Calculate gear combinations for threading on 7x12 mini-lathes</p>
                </div>
            </div>
        </div>
    </header>

    <main>
        <!-- About Section (Collapsible) -->
        <div class="collapsible-section">
            <div class="collapsible-header" onclick="toggleCollapsible('about')">
                <h3>About This Calculator</h3>
                <span class="collapsible-toggle" id="about-toggle">â–¼</span>
            </div>
            <div class="collapsible-content" id="about-content">
                <div class="collapsible-content-inner">
                    <p>This tool can calculate alternative gears that can be used to cut a particular thread on a 7x12 mini-lathe like the Sieg SC2.
                    It works with either a 1.5&nbsp;mm pitch leadscrew or a 16&nbsp;TPI one.</p>

                    <p>The calculator is heavily based on the work of <a href="http://www.varmintal.com/alath.htm" target="_blank" rel="noopener">Al&nbsp;Harral</a>.
                    The code is based on Al&nbsp;Harral's <a href="http://www.varmintal.com/gears.bas" target="_blank" rel="noopener">GEARS.BAS</a>,
                    originally ported to the web by <a href="https://www.cgtk.co.uk/metalwork/calculators/changegears/minilathe" target="_blank" rel="noopener">A.&nbsp;S.&nbsp;Budden</a>,
                    and modernized to modern JavaScript for offline use.</p>
                </div>
            </div>
        </div>

        <section class="calculator">
            <h2>Calculator</h2>

            <!-- Setup Section (Collapsible) -->
            <div class="collapsible-section">
                <div class="collapsible-header" onclick="toggleCollapsible('setup')">
                    <h3>Setup (Leadscrew & Available Gears)</h3>
                    <span class="collapsible-toggle" id="setup-toggle">â–¼</span>
                </div>
                <div class="collapsible-content" id="setup-content">
                    <div class="collapsible-content-inner">
                        <table class="calcInputForm">
                            <tbody>
                                <tr>
                                    <td>Leadscrew:</td>
                                    <td>
                                        <div class="radio-group">
                                            <label>
                                                <input type="radio" id="metric_ls" name="leadscrew_type" value="metric">
                                                Metric (1.5&nbsp;mm pitch)
                                            </label>
                                            <label>
                                                <input type="radio" id="imperial_ls" name="leadscrew_type" value="imperial" checked>
                                                Imperial (16&nbsp;tpi)
                                            </label>
                                        </div>
                                    </td>
                                </tr>
                                <tr>
                                    <td>Available Gears:</td>
                                    <td>
                                        <input type="text" id="gears1" value="" placeholder="e.g., 20,20,30,35,40,40,45">
                                        <br><br>
                                        <input type="text" id="gears2" value="" placeholder="e.g., 50,55,57,60,65,80,80">
                                        <br><br>
                                        <input type="text" id="gears3" value="" placeholder="Additional gears (optional)">
                                        <small style="display: block; margin-top: 0.5rem; color: #666;">
                                            Enter comma-separated gear tooth counts
                                        </small>
                                    </td>
                                </tr>
                                <tr>
                                    <td>Options:</td>
                                    <td>
                                        <div class="checkbox-group">
                                            <label>
                                                <input type="checkbox" id="includeall" name="includeall" checked>
                                                Always show four-gear options
                                            </label>
                                        </div>
                                    </td>
                                </tr>
                                <tr>
                                    <td></td>
                                    <td>
                                        <button type="button" onclick="saveSettings()" style="margin-top: 1rem; padding: 0.5rem 1rem; background-color: #27ae60; color: white; border: none; border-radius: 4px; cursor: pointer;">
                                            ðŸ’¾ Save Settings
                                        </button>
                                        <small style="display: block; margin-top: 0.5rem; color: #666;">
                                            Settings will be automatically loaded on next visit
                                        </small>
                                    </td>
                                </tr>
                            </tbody>
                        </table>
                    </div>
                </div>
            </div>

            <!-- Calculate Single Thread Section (Collapsible) -->
            <div class="collapsible-section">
                <div class="collapsible-header" onclick="toggleCollapsible('single')">
                    <h3>Calculate Single Thread</h3>
                    <span class="collapsible-toggle" id="single-toggle">â–¼</span>
                </div>
                <div class="collapsible-content" id="single-content">
                    <div class="collapsible-content-inner">
                        <form class="calc-form">
                            <table class="calcInputForm">
                                <tbody>
                                    <tr>
                                        <td>Target Type:</td>
                                        <td>
                                            <div class="radio-group">
                                                <label>
                                                    <input type="radio" id="getpitch" name="target" value="pitch">
                                                    Metric Pitch (mm)
                                                </label>
                                                <label>
                                                    <input type="radio" id="gettpi" name="target" value="tpi" checked>
                                                    Imperial TPI (threads per inch)
                                                </label>
                                            </div>
                                        </td>
                                    </tr>
                                    <tr id="pitch-row" class="hidden">
                                        <td>Target Pitch:</td>
                                        <td>
                                            <input type="number" id="pitch" name="pitch" min="0.1" step="0.05" value="1.5">
                                            <small style="display: inline-block; margin-left: 0.5rem; color: #666;">mm</small>
                                        </td>
                                    </tr>
                                    <tr id="tpi-row">
                                        <td>Target TPI:</td>
                                        <td>
                                            <input type="number" id="tpi" name="tpi" min="0.5" step="0.5" value="16">
                                            <small style="display: inline-block; margin-left: 0.5rem; color: #666;">threads per inch</small>
                                        </td>
                                    </tr>
                                    <tr>
                                        <td></td>
                                        <td>
                                            <input type="submit" value="Calculate Gear Combinations">
                                        </td>
                                    </tr>
                                </tbody>
                            </table>
                        </form>

                        <div style="margin-top: 2rem;">
                            <h4>Results</h4>
                            <div id="holder">
                                <p class="info-message">Enter your parameters above and click "Calculate Gear Combinations" to see results.</p>
                            </div>
                        </div>
                    </div>
                </div>
            </div>

            <!-- Calculate Threading Chart Section (Collapsible) -->
            <div class="collapsible-section">
                <div class="collapsible-header" onclick="toggleCollapsible('chart')">
                    <h3>Calculate Threading Chart</h3>
                    <span class="collapsible-toggle open" id="chart-toggle">â–¼</span>
                </div>
                <div class="collapsible-content open" id="chart-content">
                    <div class="collapsible-content-inner">
                        <p style="color: #666; margin-bottom: 1rem;">
                            Generate a chart of gear combinations for multiple thread specifications at once.
                        </p>

                        <table class="calcInputForm">
                            <tbody>
                                <tr>
                                    <td style="vertical-align: top;">Target TPI Values:</td>
                                    <td>
                                        <textarea id="chart-tpi" rows="4" style="width: 100%; max-width: 400px; padding: 0.5rem; border: 1px solid #ddd; border-radius: 4px; font-family: inherit;" placeholder="e.g., 8,10,12,14,16,18,20,24">8,9,11,12,13,14,16,18,20,24,28,32,36,40,44,48,56,64,72,80</textarea>
                                        <small style="display: block; margin-top: 0.5rem; color: #666;">
                                            Enter comma-separated TPI values (Imperial)
                                        </small>
                                    </td>
                                </tr>
                                <tr>
                                    <td style="vertical-align: top;">Target Pitch Values:</td>
                                    <td>
                                        <textarea id="chart-pitch" rows="4" style="width: 100%; max-width: 400px; padding: 0.5rem; border: 1px solid #ddd; border-radius: 4px; font-family: inherit;" placeholder="e.g., 0.5,0.75,1.0,1.25,1.5,2.0">.40,.45,.50,.65,.70,.75,.8,.9,1.0,1.25,1.5,1.75,2.0,2.5</textarea>
                                        <small style="display: block; margin-top: 0.5rem; color: #666;">
                                            Enter comma-separated pitch values in mm (Metric)
                                        </small>
                                    </td>
                                </tr>
                                <tr>
                                    <td></td>
                                    <td>
                                        <button type="button" onclick="calculateThreadChart()" style="padding: 0.75rem 1.5rem; background-color: #3498db; color: white; border: none; border-radius: 4px; cursor: pointer; font-size: 1rem; font-weight: bold;">
                                            ðŸ“Š Calculate Thread Chart
                                        </button>
                                    </td>
                                </tr>
                            </tbody>
                        </table>

                        <div id="chart-results" style="margin-top: 2rem;">
                            <p class="info-message">Enter TPI and/or pitch values above and click "Calculate Thread Chart" to generate the chart.</p>
                        </div>
                    </div>
                </div>
            </div>

            <!-- Image Reference Section (Collapsible, Open by Default) -->
            <div class="collapsible-section">
                <div class="collapsible-header" onclick="toggleCollapsible('imageref')">
                    <h3>Image Reference</h3>
                    <span class="collapsible-toggle open" id="imageref-toggle">â–¼</span>
                </div>
                <div class="collapsible-content open" id="imageref-content">
                    <div class="collapsible-content-inner">
                        <div class="image-container" style="text-align: center; background: white; padding: 2rem; border-radius: 8px;">
                            <svg id="gears-svg" width="1024pt" height="1348pt" viewBox="0 0 1024 1348" version="1.1" style="max-width: 100%; height: auto; max-height: 900px;" xmlns="http://www.w3.org/2000/svg">
                                <g id="gear-group" transform="matrix(1.0879653,0,0,1.0879653,-64.697158,-169.99872)">
                                    <path style="opacity:0.55;fill:#ff0000;stroke-width:0.75" d="m 486.11331,817.13333 v -10.64821 l -8.33338,-2.31479 1.85186,-11.11118 c 0,0 8.33338,-3.70373 5.55558,-3.70373 -2.77779,0 -8.33337,-8.79637 -8.33337,-8.79637 V 762.0405 l 7.87041,-14.35194 6.48151,-8.79634 7.8704,-10.18522 9.72228,-2.77779 8.33337,-10.18524 13.42598,-0.46296 28.24087,1.85186 25.92604,7.40744 2.31482,6.94448 7.40745,-3.24076 1.85186,8.33337 6.94447,22.22235 c 0,0 9.72227,10.6482 3.70372,8.7963 -6.01854,-1.85182 -18.05563,-8.33332 -18.05563,-8.33332 l -13.88895,-3.70373 -17.59268,1.85183 -14.81487,13.42597 -1.3889,13.88895 4.16668,16.20383 7.87041,11.1111 13.42599,6.0186 11.11116,0.46297 5.55558,1.38885 -5.55558,14.35192 -1.85186,2.3148 -7.87041,-7.87035 -3.24076,6.94448 -1.38889,7.87035 -6.94447,-1.85183 -3.70372,-11.57415 -8.33338,9.25935 -6.01854,-0.92595 -0.46297,-14.8149 -10.64819,7.87043 -12.96302,-3.24075 z" id="GearA" />
                                    <path style="opacity:0.55;fill:#00ff00;stroke-width:0.75" d="m 482.87255,837.50377 c -37.3765,24.53714 -86.33688,58.79658 -122.22277,186.11193 -19.98032,70.8858 15.23077,198.8714 106.01899,226.8529 92.91414,28.6368 148.14882,-14.8149 148.14882,-14.8149 l -10.18523,-12.037 2.77779,-7.8705 -7.40744,-1.3889 3.24076,-10.6482 -8.33338,-3.7037 -10.18523,8.7964 -27.31494,12.963 -15.27784,0.9259 19.44453,-115.7413 v -5.0926 l -15.27785,-2.3148 -8.79634,-0.463 -4.62964,23.6112 -16.20378,96.2968 -1.3889,6.0185 -29.16679,-5.0925 -10.18523,-5.0927 -0.92594,-2.3148 -15.27784,-10.6482 -23.61122,-28.2409 -5.55558,-10.1852 40.74092,-36.1113 50.46319,-42.5928 5.55559,-7.8703 0.92593,-6.0186 2.31482,-6.4815 4.16668,-6.0186 0.46297,-4.1667 -9.2593,-3.2407 10.18523,-6.4815 1.38889,-3.7037 -5.55558,-9.2593 2.31483,-2.7779 8.33337,-4.6296 0.92593,-4.6296 -3.24076,-5.0927 11.11117,-5.5555 12.50006,-8.7963 7.8704,-0.926 c 0,0 9.72226,6.9445 11.57413,6.9445 1.85186,0 13.88895,5.0926 13.88895,5.0926 l 6.94447,-2.3148 -1.38889,-5.5556 -28.70383,-8.79637 -1.85186,-5.09258 17.59267,-124.53765 4.62965,-2.77777 27.31494,6.4815 27.31494,17.1297 -31.48163,-16.66673 5.09262,8.3334 22.22232,16.66673 11.11116,20.37045 5.09262,-5.09258 v -6.0186 l 10.18523,-2.77777 1.38889,-1.38893 c 0,0 -1.38889,-5.09257 0.46297,-10.64812 1.85186,-5.55563 3.24076,-13.42605 3.24076,-13.42605 h -9.72227 l 5.55558,-9.25928 -5.09262,-1.85182 -9.72226,4.16662 7.40744,-8.7963 v -3.24075 l -3.70373,-4.1667 -10.18523,6.94448 3.70373,-11.57415 -8.33337,-1.85183 -4.16669,7.40745 -0.46297,-14.35192 -20.83342,-6.94448 -6.01855,4.62968 -6.01855,-6.48158 -5.55558,-1.38885 -1.85186,6.01853 -5.55558,-10.18523 -12.50005,2.3148 -9.72227,9.25935 -6.48151,-2.31487 -3.70372,8.79637 -5.55558,2.3148 -4.62965,-11.11117 -5.55558,5.55562 h -7.40745 l -5.09261,-6.94447 -22.22232,-1.38891 31.94459,36.11128 18.98157,-5.55562 -18.98157,130.55617 -13.88895,5.09258 -5.55558,5.55567 -79.16703,-55.09287 -6.48151,18.51855 69.44476,51.38922 -3.24075,9.2592 -3.24076,37.0372 -6.48152,7.4075 -77.31515,61.1114 -6.48152,-37.5002 3.24076,-67.1299 10.6482,-42.59282 16.20378,-24.53719 7.40743,-21.29636 24.07419,-30.55568 31.94459,-25.00012 34.2594,-17.59268 5.09263,-1.85182 -32.87052,-33.33353 c 0,0 -13.42599,1.38893 -29.62977,6.94447 z" id="GearB" />
                                    <path style="opacity:0.55;fill:#000080;stroke-width:0.75" d="m 529.40054,1053.014 -2.08334,-5.0926 8.79633,-4.8611 0.69445,-6.9445 c 0,0 -13.88895,-3.0092 -1.85186,-9.0278 12.03709,-6.0185 2.77779,-2.5463 2.77779,-2.5463 l 5.78706,-2.7778 c 0,0 -5.78706,-3.2408 -2.54631,-6.713 3.24076,-3.4723 7.17596,-6.9445 7.17596,-6.9445 l 14.5834,-5.0926 4.62965,-4.16672 19.21305,5.78712 12.73154,7.4074 2.08334,-0.9259 2.31483,-5.5556 4.62965,0.6944 1.62038,9.9538 6.71299,-7.176 4.16669,3.0093 1.15741,6.713 c 0,0 -0.92593,6.9445 1.38889,6.9445 2.31483,0 5.3241,-0.9259 5.3241,-0.9259 l 2.08334,3.2407 -1.62037,7.1759 -1.62038,7.639 -17.36119,-7.176 -8.56485,-1.3888 -10.6482,6.2499 -6.94448,12.0372 -0.92592,21.2964 9.02781,12.2685 15.9723,3.2408 8.33337,-0.2315 -0.92593,14.1204 -11.34265,-1.3889 -2.31482,12.5001 -11.57413,-7.639 c 0,0 -12.50005,7.8705 -12.73153,6.0186 -0.23149,-1.8519 -14.35192,-13.6575 -14.35192,-13.6575 l -18.05564,-8.3333 -5.55558,-3.2408 4.16668,-27.0834 -7.40743,3.2407 -6.713,6.2501 0.92593,-7.176 5.78707,-4.8611 -6.48152,-3.2408 z" id="GearC" />
                                    <path style="opacity:0.55;fill:#ff6600;stroke-width:0.75" d="m 786.57765,1057.8751 96.99113,-83.56515 4.8612,-16.8982 c 0,0 -1.38893,-1.38893 -3.70373,-1.8519 -2.31487,-0.46298 -22.02321,-106.20277 -162.0378,-82.87073 -85.53354,14.25331 -121.29685,119.445 -121.29685,125.46353 0,6.01855 12.50006,3.70375 12.50006,3.70375 l 10.18523,10.6482 -4.16669,7.8704 8.79634,3.7037 2.77779,6.0185 -3.24076,8.3334 2.31483,7.4074 3.24076,15.2779 -6.48151,21.7594 -9.2593,5.0925 -2.31483,12.0372 -5.55558,4.1667 -6.48151,6.0185 -23.14825,7.8704 -10.18524,6.0185 c 0,0 0.46297,-1.8518 2.31483,4.1667 1.85186,6.0186 21.14054,152.2785 126.85242,150.4637 107.87084,-1.8519 196.2587,-109.7784 196.29721,-230.0937 0.0129,-40.3868 8.33336,-63.4262 -4.62966,-78.24105 -46.7598,-53.43962 -13.65748,7.17595 -13.65748,7.17595 l -23.37976,23.8427 3.70373,5.5556 0.46297,52.3151 -12.50003,60.1854 -4.1667,6.9444 -23.14822,-14.8148 -17.12977,-11.8686 -4.16663,16.0352 -10.6482,7.4075 41.20388,19.9075 -0.46298,8.3334 -17.1297,33.7965 -32.40757,31.4815 -25.00013,13.4261 0.92595,-104.6301 -11.57412,-7.8705 -14.35192,14.352 -1.38889,9.2592 -0.46296,100.0005 -30.5557,0.4629 -35.18534,-23.6112 c 0,0 -16.66674,-15.7407 -14.81489,-19.9074 1.85187,-4.1667 76.8522,-70.8337 76.8522,-70.8337 l 8.79634,1.3889 12.53297,-10.6482 -21.32931,-21.7594 -26.389,11.5742 -61.57436,57.8706 -3.24075,1.3889 -4.16669,-28.7038 -1.38889,-50.0003 4.16668,-6.4815 6.01855,-26.389 -2.77779,-11.1111 -1.85186,-6.9445 5.55558,-1.8519 55.5558,28.2409 6.48152,12.5001 -3.70373,18.5185 6.01855,12.5001 21.75936,-12.0371 -1.85186,-16.2038 9.72226,-17.1297 -85.64853,-48.1483 2.31482,-7.8704 9.72227,-21.7594 c 0,0 13.42599,-16.66673 15.27785,-23.14823 1.85186,-6.4815 26.85197,-26.85202 26.85197,-26.85202 l 31.94459,-20.83343 16.20378,-3.24075 c 0,0 -6.01855,12.03713 -6.48151,14.8149 -0.46297,2.77778 -10.18524,88.88933 -10.18524,88.88933 l -4.16668,17.5927 -18.51861,17.1297 21.75936,13.4259 11.11117,-10.1852 13.53835,-3.1846 2.66541,-21.8155 15.27788,-125.46353 18.51855,4.6296 c 0,0 16.20382,6.48158 23.61127,12.96308 7.40745,6.4815 25.00013,26.38897 25.00013,26.38897 l 10.18522,21.75938 -17.1297,14.35192 -41.66692,36.57418 -21.7593,18.0557 -12.96308,-6.4815 -3.70365,22.2223 z" id="GearD" />
                                </g>
                            </svg>
                            <p style="color: #666; font-size: 0.9rem; margin-top: 1rem;">
                                Reference diagram showing gear positions and configuration<br>
                                <em style="font-size: 0.85rem;">Hover over gears in the diagram or table columns to highlight</em>
                            </p>
                        </div>
                    </div>
                </div>
            </div>

            <!-- How to Use Section (Collapsible) -->
            <div class="collapsible-section">
                <div class="collapsible-header" onclick="toggleCollapsible('howto')">
                    <h3>How to Use This Calculator</h3>
                    <span class="collapsible-toggle" id="howto-toggle">â–¼</span>
                </div>
                <div class="collapsible-content" id="howto-content">
                    <div class="collapsible-content-inner">
                        <h4>Quick Start</h4>
                        <ol>
                            <li><strong>Select your leadscrew type:</strong> Choose between metric (1.5mm pitch) or imperial (16 TPI)</li>
                            <li><strong>Enter available gears:</strong> List the gear tooth counts you have available, separated by commas</li>
                            <li><strong>Choose target type:</strong> Select whether you want to cut metric threads (pitch in mm) or imperial threads (TPI)</li>
                            <li><strong>Enter target value:</strong> Specify the pitch or TPI you want to achieve</li>
                            <li><strong>Calculate:</strong> Click the button to see all possible gear combinations</li>
                        </ol>

                        <h4>Understanding the Results</h4>
                        <ul>
                            <li><strong>Gear A:</strong> Driver gear on the spindle (easy to change)</li>
                            <li><strong>Gear B:</strong> Idler gear (if needed) - "ANY" means any gear will work (hard to change)</li>
                            <li><strong>Gear C:</strong> Second idler gear (if needed) (hard to change)</li>
                            <li><strong>Gear D:</strong> Driven gear on the leadscrew (easy to change)</li>
                            <li><strong>Actual Value:</strong> The precise pitch or TPI you'll achieve with this combination</li>
                            <li><strong>Error %:</strong> How far off from the target (lower is better)</li>
                        </ul>

                        <p><strong>ðŸ’¡ Tip:</strong> The calculator strongly prefers 2-gear solutions (B=ANY, C=-) because gears B and C are difficult to change. This minimizes setup time!</p>

                        <h4>Gear Configuration Diagram</h4>
                        <div class="image-container">
                            <img src="images/change_gears.webp" alt="Mini-lathe change gear configuration diagram" loading="lazy">
                            <p style="text-align: center; color: #666; font-size: 0.9rem; margin-top: 0.5rem;">
                                Diagram showing the change gear configuration on a mini-lathe
                            </p>
                        </div>

                        <h4>How/Where to Change Gears</h4>
                        <p><strong>General Tips:</strong></p>
                        <ul>
                            <li>Change gears are commonly tight on the shaft when new. You might need to use a screwdriver behind them to pry them off.</li>
                            <li><strong>Positions A & D (Easy):</strong> These gears are on the spindle and leadscrew. Change these frequently for different threads.</li>
                            <li><strong>Positions B & C (Hard):</strong> These are on a hollow shaft that comes off when the retaining socket head cap screw is removed. Use an arbor press to remove gears from the hollow shaft. <strong>Be careful not to lose the key!</strong></li>
                        </ul>

                        <p><strong>Position D Spacer:</strong></p>
                        <p>Gear position D has a spacer behind the gear. When you only use three gears (2-gear solution), put the spacer <em>outside</em> the gear so it will align with the gear in position B.</p>

                        <p><strong>Understanding "ANY" Gear:</strong></p>
                        <p>Many combinations show "ANY" in columns B and C. This means you can use a gear with any number of teeth in position B - it's an idler and doesn't affect the overall gear ratio. Use a gear that makes it easy to properly engage the gears. For position C, any gear acts only as a spacer and doesn't engage other gears.</p>
                    </div>
                </div>
            </div>
    </main>

    <footer>
        <p>
            <strong>Mini-Lathe Change Gear Calculator</strong><br>
            Based on Al Harral's GEARS.BAS | Original web version by A. S. Budden (<a href="https://www.cgtk.co.uk/metalwork/calculators/changegears/minilathe" target="_blank" rel="noopener">CGTK.co.uk</a>) | Modernized for offline use<br>
            <small>This is a free, open-source tool for the machining community</small>
        </p>
    </footer>

    <script src="js/calculator.js"></script>
</body>
</html>

